scale_y_log10(breaks=c(1E4, 2E4, 4E4, 8E4, 16E4, 32E4), labels=c("$10", "$20", "$40", "$80", "$160", "$320")) +
labs(title=paste(title, "Nationwide", sep="\n"), x="DRG", y="Average Covered Charges ($1,000s)") +
theme_bw() +
theme(legend.position="bottom", panel.grid.major.x=NULL, panel.grid.major.y=element_line(color="grey"), panel.grid.minor.y=NULL)
}
for (i in 1:length(mdcOHSU)) {
d <- subset(dfSubset, mdc == mdcOHSU[i])
t <- paste("MDC", mdc$mdc[mdc == mdcOHSU[1]], mdc$mdclab[1])
DistnPlot(d, t)
}
View(d)
DistnPlot <- function(d, title) {
ggplot(d, aes(x=DRGchar, y=Average.Covered.Charges)) +
#     geom_boxplot(alpha=1/2, fill="grey", outlier.size=0) +
geom_violin(alpha=1/2, fill="grey") +
geom_point(data=d[grep("^OR - Portland", df$Hospital.Referral.Region.Description),], alpha=1/2, na.rm=TRUE) +
geom_point(data=d[d$OHSU,], color=rgb(0, 73, 144, max=255), size=5) +
facet_wrap(~ type, ncol=1) +
scale_y_log10(breaks=c(1E4, 2E4, 4E4, 8E4, 16E4, 32E4), labels=c("$10", "$20", "$40", "$80", "$160", "$320")) +
labs(title=paste(title, "Nationwide", sep="\n"), x="DRG", y="Average Covered Charges ($1,000s)") +
theme_bw() +
theme(legend.position="bottom", panel.grid.major.x=NULL, panel.grid.major.y=element_line(color="grey"), panel.grid.minor.y=NULL)
}
for (i in 1:1) {
d <- subset(dfSubset, mdc == mdcOHSU[i])
t <- paste("MDC", mdc$mdc[mdc == mdcOHSU[1]], mdc$mdclab[1])
DistnPlot(d, t)
}
View(d)
DistnPlot <- function(d, title) {
ggplot(d, aes(x=DRGchar, y=Average.Covered.Charges)) +
#     geom_boxplot(alpha=1/2, fill="grey", outlier.size=0) +
geom_violin(alpha=1/2, fill="grey") +
geom_point(data=d[grep("^OR - Portland", df$Hospital.Referral.Region.Description),], alpha=1/2, na.rm=TRUE) +
geom_point(data=d[d$OHSU,], color=rgb(0, 73, 144, max=255), size=5) +
facet_wrap(~ type, ncol=1) +
scale_y_log10(breaks=c(1E4, 2E4, 4E4, 8E4, 16E4, 32E4), labels=c("$10", "$20", "$40", "$80", "$160", "$320")) +
labs(title=paste(title, "Nationwide", sep="\n"), x="DRG", y="Average Covered Charges ($1,000s)") +
theme_bw() +
theme(legend.position="bottom", panel.grid.major.x=NULL, panel.grid.major.y=element_line(color="grey"), panel.grid.minor.y=NULL)
}
for (i in 1:1) {
d <- subset(dfSubset, mdc == mdcOHSU[i])
t <- paste("MDC", mdc$mdc[mdc == mdcOHSU[1]], mdc$mdclab[mdc == mdcOHSU[1]])
DistnPlot(d, t)
}
DistnPlot <- function(d, title) {
ggplot(d, aes(x=DRGchar, y=Average.Covered.Charges)) +
#     geom_boxplot(alpha=1/2, fill="grey", outlier.size=0) +
geom_violin(alpha=1/2, fill="grey") +
geom_point(data=d[grep("^OR - Portland", df$Hospital.Referral.Region.Description),], alpha=1/2, na.rm=TRUE) +
geom_point(data=d[d$OHSU,], color=rgb(0, 73, 144, max=255), size=5) +
facet_wrap(~ type, ncol=1) +
scale_y_log10(breaks=c(1E4, 2E4, 4E4, 8E4, 16E4, 32E4), labels=c("$10", "$20", "$40", "$80", "$160", "$320")) +
labs(title=paste(title, "Nationwide", sep="\n"), x="DRG", y="Average Covered Charges ($1,000s)") +
theme_bw() +
theme(legend.position="bottom", panel.grid.major.x=NULL, panel.grid.major.y=element_line(color="grey"), panel.grid.minor.y=NULL)
}
for (i in 1:1) {
j <- mdc == mdcOHSU[i]
d <- subset(dfSubset, mdc == mdcOHSU[i])
t <- paste("MDC", mdc$mdc[mdc == mdcOHSU[1]], mdc$mdclab[mdc == mdcOHSU[1]])
DistnPlot(d, t)
}
View(j)
DistnPlot <- function(d, title) {
ggplot(d, aes(x=DRGchar, y=Average.Covered.Charges)) +
#     geom_boxplot(alpha=1/2, fill="grey", outlier.size=0) +
geom_violin(alpha=1/2, fill="grey") +
geom_point(data=d[grep("^OR - Portland", df$Hospital.Referral.Region.Description),], alpha=1/2, na.rm=TRUE) +
geom_point(data=d[d$OHSU,], color=rgb(0, 73, 144, max=255), size=5) +
facet_wrap(~ type, ncol=1) +
scale_y_log10(breaks=c(1E4, 2E4, 4E4, 8E4, 16E4, 32E4), labels=c("$10", "$20", "$40", "$80", "$160", "$320")) +
labs(title=paste(title, "Nationwide", sep="\n"), x="DRG", y="Average Covered Charges ($1,000s)") +
theme_bw() +
theme(legend.position="bottom", panel.grid.major.x=NULL, panel.grid.major.y=element_line(color="grey"), panel.grid.minor.y=NULL)
}
for (i in 1:1) {
j <- mdcOHSU[i]
d <- subset(dfSubset, mdc == mdcOHSU[i])
t <- paste("MDC", mdc$mdc[mdc == mdcOHSU[1]], mdc$mdclab[mdc == mdcOHSU[1]])
DistnPlot(d, t)
}
DistnPlot <- function(d, title) {
ggplot(d, aes(x=DRGchar, y=Average.Covered.Charges)) +
#     geom_boxplot(alpha=1/2, fill="grey", outlier.size=0) +
geom_violin(alpha=1/2, fill="grey") +
geom_point(data=d[grep("^OR - Portland", df$Hospital.Referral.Region.Description),], alpha=1/2, na.rm=TRUE) +
geom_point(data=d[d$OHSU,], color=rgb(0, 73, 144, max=255), size=5) +
facet_wrap(~ type, ncol=1) +
scale_y_log10(breaks=c(1E4, 2E4, 4E4, 8E4, 16E4, 32E4), labels=c("$10", "$20", "$40", "$80", "$160", "$320")) +
labs(title=paste(title, "Nationwide", sep="\n"), x="DRG", y="Average Covered Charges ($1,000s)") +
theme_bw() +
theme(legend.position="bottom", panel.grid.major.x=NULL, panel.grid.major.y=element_line(color="grey"), panel.grid.minor.y=NULL)
}
for (i in 1:1) {
j <- mdcOHSU[i]
d <- subset(dfSubset, mdc == j)
t <- paste("MDC", mdc$mdc[mdc == mdcOHSU[1]], mdc$mdclab[mdc == mdcOHSU[1]])
DistnPlot(d, t)
}
DistnPlot <- function(d, title) {
ggplot(d, aes(x=DRGchar, y=Average.Covered.Charges)) +
#     geom_boxplot(alpha=1/2, fill="grey", outlier.size=0) +
geom_violin(alpha=1/2, fill="grey") +
geom_point(data=d[grep("^OR - Portland", df$Hospital.Referral.Region.Description),], alpha=1/2, na.rm=TRUE) +
geom_point(data=d[d$OHSU,], color=rgb(0, 73, 144, max=255), size=5) +
facet_wrap(~ type, ncol=1) +
scale_y_log10(breaks=c(1E4, 2E4, 4E4, 8E4, 16E4, 32E4), labels=c("$10", "$20", "$40", "$80", "$160", "$320")) +
labs(title=paste(title, "Nationwide", sep="\n"), x="DRG", y="Average Covered Charges ($1,000s)") +
theme_bw() +
theme(legend.position="bottom", panel.grid.major.x=NULL, panel.grid.major.y=element_line(color="grey"), panel.grid.minor.y=NULL)
}
for (i in 1:1) {
j <- mdcOHSU[i]
d <- subset(dfSubset, mdc == j)
t <- paste("MDC", mdc$mdc[mdc == j], mdc$mdclab[mdc == j])
DistnPlot(d, t)
}
DistnPlot <- function(d, title) {
ggplot(d, aes(x=DRGchar, y=Average.Covered.Charges)) +
#     geom_boxplot(alpha=1/2, fill="grey", outlier.size=0) +
geom_violin(alpha=1/2, fill="grey") +
geom_point(data=d[grep("^OR - Portland", df$Hospital.Referral.Region.Description),], alpha=1/2, na.rm=TRUE) +
geom_point(data=d[d$OHSU,], color=rgb(0, 73, 144, max=255), size=5) +
facet_wrap(~ type, ncol=1) +
scale_y_log10(breaks=c(1E4, 2E4, 4E4, 8E4, 16E4, 32E4), labels=c("$10", "$20", "$40", "$80", "$160", "$320")) +
labs(title=paste(title, "Nationwide", sep="\n"), x="DRG", y="Average Covered Charges ($1,000s)") +
theme_bw() +
theme(legend.position="bottom", panel.grid.major.x=NULL, panel.grid.major.y=element_line(color="grey"), panel.grid.minor.y=NULL)
}
for (i in 1:1) {
j <- mdcOHSU[i]
d <- subset(dfSubset, mdc == j)
t <- paste("MDC", mdc$mdc[mdc == j], mdc$mdclab[mdc == j])
show(DistnPlot(d, t))
}
DistnPlot <- function(d, title) {
ggplot(d, aes(x=DRGchar, y=Average.Covered.Charges)) +
#     geom_boxplot(alpha=1/2, fill="grey", outlier.size=0) +
geom_violin(alpha=1/2, fill="grey") +
geom_point(data=d[grep("^OR - Portland", df$Hospital.Referral.Region.Description),], alpha=1/2, na.rm=TRUE) +
geom_point(data=d[d$OHSU,], color=rgb(0, 73, 144, max=255), size=5) +
facet_wrap(~ type, ncol=1) +
scale_y_log10(breaks=c(1E4, 2E4, 4E4, 8E4, 16E4, 32E4), labels=c("$10", "$20", "$40", "$80", "$160", "$320")) +
labs(title=paste(title, "Nationwide", sep="\n"), x="DRG", y="Average Covered Charges ($1,000s)") +
theme_bw() +
theme(legend.position="bottom", panel.grid.major.x=NULL, panel.grid.major.y=element_line(color="grey"), panel.grid.minor.y=NULL)
}
for (i in 1:length(mdcOHSU)) {
j <- mdcOHSU[i]
d <- subset(dfSubset, mdc == j)
t <- paste("MDC", mdc$mdc[mdc == j], mdc$mdclab[mdc == j])
show(DistnPlot(d, t))
}
DistnPlot <- function(d, title) {
ggplot(d, aes(x=DRGchar, y=Average.Covered.Charges)) +
#     geom_boxplot(alpha=1/2, fill="grey", outlier.size=0) +
geom_violin(alpha=1/2, fill="grey") +
#     geom_point(data=d[grep("^OR - Portland", df$Hospital.Referral.Region.Description),], alpha=1/2, na.rm=TRUE) +
#     geom_point(data=d[d$OHSU,], color=rgb(0, 73, 144, max=255), size=5) +
facet_wrap(~ type, ncol=1) +
scale_y_log10(breaks=c(1E4, 2E4, 4E4, 8E4, 16E4, 32E4), labels=c("$10", "$20", "$40", "$80", "$160", "$320")) +
labs(title=paste(title, "Nationwide", sep="\n"), x="DRG", y="Average Covered Charges ($1,000s)") +
theme_bw() +
theme(legend.position="bottom", panel.grid.major.x=NULL, panel.grid.major.y=element_line(color="grey"), panel.grid.minor.y=NULL)
}
for (i in 3:3) {
j <- mdcOHSU[i]
d <- subset(dfSubset, mdc == j)
t <- paste("MDC", mdc$mdc[mdc == j], mdc$mdclab[mdc == j])
show(DistnPlot(d, t))
}
DistnPlot <- function(d, title) {
ggplot(d, aes(x=DRGchar, y=Average.Covered.Charges)) +
#     geom_boxplot(alpha=1/2, fill="grey", outlier.size=0) +
geom_violin(alpha=1/2, fill="grey") +
#     geom_point(data=d[grep("^OR - Portland", df$Hospital.Referral.Region.Description),], alpha=1/2, na.rm=TRUE) +
#     geom_point(data=d[d$OHSU,], color=rgb(0, 73, 144, max=255), size=5) +
facet_wrap(~ type, nrow=1) +
scale_y_log10(breaks=c(1E4, 2E4, 4E4, 8E4, 16E4, 32E4), labels=c("$10", "$20", "$40", "$80", "$160", "$320")) +
labs(title=paste(title, "Nationwide", sep="\n"), x="DRG", y="Average Covered Charges ($1,000s)") +
theme_bw() +
theme(legend.position="bottom", panel.grid.major.x=NULL, panel.grid.major.y=element_line(color="grey"), panel.grid.minor.y=NULL)
}
for (i in 3:3) {
j <- mdcOHSU[i]
d <- subset(dfSubset, mdc == j)
t <- paste("MDC", mdc$mdc[mdc == j], mdc$mdclab[mdc == j])
show(DistnPlot(d, t))
}
DistnPlot <- function(d, title) {
ggplot(d, aes(x=DRGchar, y=Average.Covered.Charges)) +
#     geom_boxplot(alpha=1/2, fill="grey", outlier.size=0) +
geom_violin(alpha=1/2, fill="grey") +
#     geom_point(data=d[grep("^OR - Portland", df$Hospital.Referral.Region.Description),], alpha=1/2, na.rm=TRUE) +
#     geom_point(data=d[d$OHSU,], color=rgb(0, 73, 144, max=255), size=5) +
facet_wrap(~ type, nrow=1) +
coord_flip() +
scale_y_log10(breaks=c(1E4, 2E4, 4E4, 8E4, 16E4, 32E4), labels=c("$10", "$20", "$40", "$80", "$160", "$320")) +
labs(title=paste(title, "Nationwide", sep="\n"), x="DRG", y="Average Covered Charges ($1,000s)") +
theme_bw() +
theme(legend.position="bottom", panel.grid.major.x=NULL, panel.grid.major.y=element_line(color="grey"), panel.grid.minor.y=NULL)
}
for (i in 3:3) {
j <- mdcOHSU[i]
d <- subset(dfSubset, mdc == j)
t <- paste("MDC", mdc$mdc[mdc == j], mdc$mdclab[mdc == j])
show(DistnPlot(d, t))
}
DistnPlot <- function(d, title) {
ggplot(d, aes(x=DRGchar, y=Average.Covered.Charges)) +
#     geom_boxplot(alpha=1/2, fill="grey", outlier.size=0) +
geom_violin(alpha=1/2, fill="grey") +
#     geom_point(data=d[grep("^OR - Portland", df$Hospital.Referral.Region.Description),], alpha=1/2, na.rm=TRUE) +
#     geom_point(data=d[d$OHSU,], color=rgb(0, 73, 144, max=255), size=5) +
facet_wrap(~ type, ncol=1) +
coord_flip() +
scale_y_log10(breaks=c(1E4, 2E4, 4E4, 8E4, 16E4, 32E4), labels=c("$10", "$20", "$40", "$80", "$160", "$320")) +
labs(title=paste(title, "Nationwide", sep="\n"), x="DRG", y="Average Covered Charges ($1,000s)") +
theme_bw() +
theme(legend.position="bottom", panel.grid.major.x=NULL, panel.grid.major.y=element_line(color="grey"), panel.grid.minor.y=NULL)
}
for (i in 3:3) {
j <- mdcOHSU[i]
d <- subset(dfSubset, mdc == j)
t <- paste("MDC", mdc$mdc[mdc == j], mdc$mdclab[mdc == j])
show(DistnPlot(d, t))
}
DistnPlot <- function(d, title) {
ggplot(d, aes(x=DRGchar, y=Average.Covered.Charges)) +
#     geom_boxplot(alpha=1/2, fill="grey", outlier.size=0) +
geom_violin(alpha=1/2, fill="grey") +
#     geom_point(data=d[grep("^OR - Portland", df$Hospital.Referral.Region.Description),], alpha=1/2, na.rm=TRUE) +
#     geom_point(data=d[d$OHSU,], color=rgb(0, 73, 144, max=255), size=5) +
facet_wrap(~ type, ncol=1, scales="free_x") +
coord_flip() +
scale_y_log10(breaks=c(1E4, 2E4, 4E4, 8E4, 16E4, 32E4), labels=c("$10", "$20", "$40", "$80", "$160", "$320")) +
labs(title=paste(title, "Nationwide", sep="\n"), x="DRG", y="Average Covered Charges ($1,000s)") +
theme_bw() +
theme(legend.position="bottom", panel.grid.major.x=NULL, panel.grid.major.y=element_line(color="grey"), panel.grid.minor.y=NULL)
}
for (i in 3:3) {
j <- mdcOHSU[i]
d <- subset(dfSubset, mdc == j)
t <- paste("MDC", mdc$mdc[mdc == j], mdc$mdclab[mdc == j])
show(DistnPlot(d, t))
}
DistnPlot <- function(d, title) {
ggplot(d, aes(x=DRGchar, y=Average.Covered.Charges)) +
#     geom_boxplot(alpha=1/2, fill="grey", outlier.size=0) +
geom_violin(alpha=1/2, fill="grey") +
#     geom_point(data=d[grep("^OR - Portland", df$Hospital.Referral.Region.Description),], alpha=1/2, na.rm=TRUE) +
#     geom_point(data=d[d$OHSU,], color=rgb(0, 73, 144, max=255), size=5) +
facet_wrap(~ type, ncol=1, scales="free_y") +
coord_flip() +
scale_y_log10(breaks=c(1E4, 2E4, 4E4, 8E4, 16E4, 32E4), labels=c("$10", "$20", "$40", "$80", "$160", "$320")) +
labs(title=paste(title, "Nationwide", sep="\n"), x="DRG", y="Average Covered Charges ($1,000s)") +
theme_bw() +
theme(legend.position="bottom", panel.grid.major.x=NULL, panel.grid.major.y=element_line(color="grey"), panel.grid.minor.y=NULL)
}
for (i in 3:3) {
j <- mdcOHSU[i]
d <- subset(dfSubset, mdc == j)
t <- paste("MDC", mdc$mdc[mdc == j], mdc$mdclab[mdc == j])
show(DistnPlot(d, t))
}
DistnPlot <- function(d, title) {
ggplot(d, aes(x=DRGchar, y=Average.Covered.Charges)) +
#     geom_boxplot(alpha=1/2, fill="grey", outlier.size=0) +
geom_violin(alpha=1/2, fill="grey") +
#     geom_point(data=d[grep("^OR - Portland", df$Hospital.Referral.Region.Description),], alpha=1/2, na.rm=TRUE) +
#     geom_point(data=d[d$OHSU,], color=rgb(0, 73, 144, max=255), size=5) +
facet_wrap(~ type, ncol=1, scales="free_y") +
scale_y_log10(breaks=c(1E4, 2E4, 4E4, 8E4, 16E4, 32E4), labels=c("$10", "$20", "$40", "$80", "$160", "$320")) +
labs(title=paste(title, "Nationwide", sep="\n"), x="DRG", y="Average Covered Charges ($1,000s)") +
theme_bw() +
theme(legend.position="bottom", panel.grid.major.x=NULL, panel.grid.major.y=element_line(color="grey"), panel.grid.minor.y=NULL)
}
for (i in 3:3) {
j <- mdcOHSU[i]
d <- subset(dfSubset, mdc == j)
t <- paste("MDC", mdc$mdc[mdc == j], mdc$mdclab[mdc == j])
show(DistnPlot(d, t))
}
DistnPlot <- function(d, title) {
ggplot(d, aes(x=DRGchar, y=Average.Covered.Charges)) +
#     geom_boxplot(alpha=1/2, fill="grey", outlier.size=0) +
geom_violin(alpha=1/2, fill="grey") +
#     geom_point(data=d[grep("^OR - Portland", df$Hospital.Referral.Region.Description),], alpha=1/2, na.rm=TRUE) +
#     geom_point(data=d[d$OHSU,], color=rgb(0, 73, 144, max=255), size=5) +
facet_wrap(~ type, ncol=1, scales="free_x") +
scale_y_log10(breaks=c(1E4, 2E4, 4E4, 8E4, 16E4, 32E4), labels=c("$10", "$20", "$40", "$80", "$160", "$320")) +
labs(title=paste(title, "Nationwide", sep="\n"), x="DRG", y="Average Covered Charges ($1,000s)") +
theme_bw() +
theme(legend.position="bottom", panel.grid.major.x=NULL, panel.grid.major.y=element_line(color="grey"), panel.grid.minor.y=NULL)
}
for (i in 3:3) {
j <- mdcOHSU[i]
d <- subset(dfSubset, mdc == j)
t <- paste("MDC", mdc$mdc[mdc == j], mdc$mdclab[mdc == j])
show(DistnPlot(d, t))
}
DistnPlot <- function(d, title) {
ggplot(d, aes(x=DRGchar, y=Average.Covered.Charges)) +
#     geom_boxplot(alpha=1/2, fill="grey", outlier.size=0) +
geom_violin(alpha=1/2, fill="grey") +
#     geom_point(data=d[grep("^OR - Portland", df$Hospital.Referral.Region.Description),], alpha=1/2, na.rm=TRUE) +
#     geom_point(data=d[d$OHSU,], color=rgb(0, 73, 144, max=255), size=5) +
facet_wrap(~ type, ncol=1, scales="free") +
scale_y_log10(breaks=c(1E4, 2E4, 4E4, 8E4, 16E4, 32E4), labels=c("$10", "$20", "$40", "$80", "$160", "$320")) +
labs(title=paste(title, "Nationwide", sep="\n"), x="DRG", y="Average Covered Charges ($1,000s)") +
theme_bw() +
theme(legend.position="bottom", panel.grid.major.x=NULL, panel.grid.major.y=element_line(color="grey"), panel.grid.minor.y=NULL)
}
for (i in 3:3) {
j <- mdcOHSU[i]
d <- subset(dfSubset, mdc == j)
t <- paste("MDC", mdc$mdc[mdc == j], mdc$mdclab[mdc == j])
show(DistnPlot(d, t))
}
DistnPlot <- function(d, title) {
ggplot(d, aes(x=DRGchar, y=Average.Covered.Charges)) +
#     geom_boxplot(alpha=1/2, fill="grey", outlier.size=0) +
geom_violin(alpha=1/2, fill="grey") +
#     geom_point(data=d[grep("^OR - Portland", df$Hospital.Referral.Region.Description),], alpha=1/2, na.rm=TRUE) +
geom_point(data=d[d$OHSU,], color=rgb(0, 73, 144, max=255), size=5) +
facet_wrap(~ type, ncol=1, scales="free") +
scale_y_log10(breaks=c(1E4, 2E4, 4E4, 8E4, 16E4, 32E4), labels=c("$10", "$20", "$40", "$80", "$160", "$320")) +
labs(title=paste(title, "Nationwide", sep="\n"), x="DRG", y="Average Covered Charges ($1,000s)") +
theme_bw() +
theme(legend.position="bottom", panel.grid.major.x=NULL, panel.grid.major.y=element_line(color="grey"), panel.grid.minor.y=NULL)
}
for (i in 3:3) {
j <- mdcOHSU[i]
d <- subset(dfSubset, mdc == j)
t <- paste("MDC", mdc$mdc[mdc == j], mdc$mdclab[mdc == j])
show(DistnPlot(d, t))
}
DistnPlot <- function(d, title) {
ggplot(d, aes(x=DRGchar, y=Average.Covered.Charges)) +
#     geom_boxplot(alpha=1/2, fill="grey", outlier.size=0) +
geom_violin(alpha=1/2, fill="grey") +
geom_point(data=d[grep("^OR - Portland", df$Hospital.Referral.Region.Description),], alpha=1/2, na.rm=TRUE) +
#     geom_point(data=d[d$OHSU,], color=rgb(0, 73, 144, max=255), size=5) +
facet_wrap(~ type, ncol=1, scales="free") +
scale_y_log10(breaks=c(1E4, 2E4, 4E4, 8E4, 16E4, 32E4), labels=c("$10", "$20", "$40", "$80", "$160", "$320")) +
labs(title=paste(title, "Nationwide", sep="\n"), x="DRG", y="Average Covered Charges ($1,000s)") +
theme_bw() +
theme(legend.position="bottom", panel.grid.major.x=NULL, panel.grid.major.y=element_line(color="grey"), panel.grid.minor.y=NULL)
}
for (i in 3:3) {
j <- mdcOHSU[i]
d <- subset(dfSubset, mdc == j)
t <- paste("MDC", mdc$mdc[mdc == j], mdc$mdclab[mdc == j])
show(DistnPlot(d, t))
}
DistnPlot <- function(d, title) {
ggplot(d, aes(x=DRGchar, y=Average.Covered.Charges)) +
#     geom_boxplot(alpha=1/2, fill="grey", outlier.size=0) +
geom_violin(alpha=1/2, fill="grey") +
#     geom_point(data=d[grep("^OR - Portland", df$Hospital.Referral.Region.Description),], alpha=1/2, na.rm=TRUE) +
geom_point(data=d[d$OHSU,], color=rgb(0, 73, 144, max=255), size=5) +
facet_wrap(~ type, ncol=1, scales="free") +
scale_y_log10(breaks=c(1E4, 2E4, 4E4, 8E4, 16E4, 32E4), labels=c("$10", "$20", "$40", "$80", "$160", "$320")) +
labs(title=paste(title, "Nationwide", sep="\n"), x="DRG", y="Average Covered Charges ($1,000s)") +
theme_bw() +
theme(legend.position="bottom", panel.grid.major.x=NULL, panel.grid.major.y=element_line(color="grey"), panel.grid.minor.y=NULL)
}
for (i in 3:3) {
j <- mdcOHSU[i]
d <- subset(dfSubset, mdc == j)
d2 <- d[grep("^OR - Portland", df$Hospital.Referral.Region.Description),]
t <- paste("MDC", mdc$mdc[mdc == j], mdc$mdclab[mdc == j])
show(DistnPlot(d, t))
}
View(`d2`)
DistnPlot <- function(d, title) {
ggplot(d, aes(x=DRGchar, y=Average.Covered.Charges)) +
#     geom_boxplot(alpha=1/2, fill="grey", outlier.size=0) +
geom_violin(alpha=1/2, fill="grey") +
#     geom_point(data=d[grep("^OR - Portland", df$Hospital.Referral.Region.Description),], alpha=1/2, na.rm=TRUE) +
geom_point(data=d[d$OHSU,], color=rgb(0, 73, 144, max=255), size=5) +
facet_wrap(~ type, ncol=1, scales="free") +
scale_y_log10(breaks=c(1E4, 2E4, 4E4, 8E4, 16E4, 32E4), labels=c("$10", "$20", "$40", "$80", "$160", "$320")) +
labs(title=paste(title, "Nationwide", sep="\n"), x="DRG", y="Average Covered Charges ($1,000s)") +
theme_bw() +
theme(legend.position="bottom", panel.grid.major.x=NULL, panel.grid.major.y=element_line(color="grey"), panel.grid.minor.y=NULL)
}
for (i in 3:3) {
j <- mdcOHSU[i]
d <- subset(dfSubset, mdc == j)
d2 <- d[grepl("^OR - Portland", df$Hospital.Referral.Region.Description),]
t <- paste("MDC", mdc$mdc[mdc == j], mdc$mdclab[mdc == j])
show(DistnPlot(d, t))
}
View(`d2`)
DistnPlot <- function(d, title) {
ggplot(d, aes(x=DRGchar, y=Average.Covered.Charges)) +
#     geom_boxplot(alpha=1/2, fill="grey", outlier.size=0) +
geom_violin(alpha=1/2, fill="grey") +
#     geom_point(data=d[grep("^OR - Portland", df$Hospital.Referral.Region.Description),], alpha=1/2, na.rm=TRUE) +
geom_point(data=d[d$OHSU,], color=rgb(0, 73, 144, max=255), size=5) +
facet_wrap(~ type, ncol=1, scales="free") +
scale_y_log10(breaks=c(1E4, 2E4, 4E4, 8E4, 16E4, 32E4), labels=c("$10", "$20", "$40", "$80", "$160", "$320")) +
labs(title=paste(title, "Nationwide", sep="\n"), x="DRG", y="Average Covered Charges ($1,000s)") +
theme_bw() +
theme(legend.position="bottom", panel.grid.major.x=NULL, panel.grid.major.y=element_line(color="grey"), panel.grid.minor.y=NULL)
}
for (i in 3:3) {
j <- mdcOHSU[i]
d <- subset(dfSubset, mdc == j)
d2 <- d[grepl("^OR - Portland", dfSubset$Hospital.Referral.Region.Description),]
t <- paste("MDC", mdc$mdc[mdc == j], mdc$mdclab[mdc == j])
show(DistnPlot(d, t))
}
View(`d2`)
DistnPlot <- function(d, title) {
ggplot(d, aes(x=DRGchar, y=Average.Covered.Charges)) +
#     geom_boxplot(alpha=1/2, fill="grey", outlier.size=0) +
geom_violin(alpha=1/2, fill="grey") +
#     geom_point(data=d[grep("^OR - Portland", df$Hospital.Referral.Region.Description),], alpha=1/2, na.rm=TRUE) +
geom_point(data=d[d$OHSU,], color=rgb(0, 73, 144, max=255), size=5) +
facet_wrap(~ type, ncol=1, scales="free") +
scale_y_log10(breaks=c(1E4, 2E4, 4E4, 8E4, 16E4, 32E4), labels=c("$10", "$20", "$40", "$80", "$160", "$320")) +
labs(title=paste(title, "Nationwide", sep="\n"), x="DRG", y="Average Covered Charges ($1,000s)") +
theme_bw() +
theme(legend.position="bottom", panel.grid.major.x=NULL, panel.grid.major.y=element_line(color="grey"), panel.grid.minor.y=NULL)
}
for (i in 3:3) {
j <- mdcOHSU[i]
d <- subset(dfSubset, mdc == j)
d2 <- d[grepl("^OR - Portland", d$Hospital.Referral.Region.Description),]
t <- paste("MDC", mdc$mdc[mdc == j], mdc$mdclab[mdc == j])
show(DistnPlot(d, t))
}
View(`d2`)
DistnPlot <- function(d, title) {
ggplot(d, aes(x=DRGchar, y=Average.Covered.Charges)) +
#     geom_boxplot(alpha=1/2, fill="grey", outlier.size=0) +
geom_violin(alpha=1/2, fill="grey") +
geom_point(data=d[grep("^OR - Portland", d$Hospital.Referral.Region.Description),], alpha=1/2, na.rm=TRUE) +
geom_point(data=d[d$OHSU,], color=rgb(0, 73, 144, max=255), size=5) +
facet_wrap(~ type, ncol=1, scales="free") +
scale_y_log10(breaks=c(1E4, 2E4, 4E4, 8E4, 16E4, 32E4), labels=c("$10", "$20", "$40", "$80", "$160", "$320")) +
labs(title=paste(title, "Nationwide", sep="\n"), x="DRG", y="Average Covered Charges ($1,000s)") +
theme_bw() +
theme(legend.position="bottom", panel.grid.major.x=NULL, panel.grid.major.y=element_line(color="grey"), panel.grid.minor.y=NULL)
}
for (i in 3:3) {
j <- mdcOHSU[i]
d <- subset(dfSubset, mdc == j)
t <- paste("MDC", mdc$mdc[mdc == j], mdc$mdclab[mdc == j])
show(DistnPlot(d, t))
}
DistnPlot <- function(d, title) {
ggplot(d, aes(x=DRGchar, y=Average.Covered.Charges)) +
#     geom_boxplot(alpha=1/2, fill="grey", outlier.size=0) +
geom_violin(alpha=1/2, fill="grey") +
geom_point(data=d[grep("^OR - Portland", d$Hospital.Referral.Region.Description),], alpha=1/2, na.rm=TRUE) +
geom_point(data=d[d$OHSU,], alpha=1/2, color=rgb(0, 73, 144, max=255), size=5) +
facet_wrap(~ type, ncol=1, scales="free") +
scale_y_log10(breaks=c(1E4, 2E4, 4E4, 8E4, 16E4, 32E4), labels=c("$10", "$20", "$40", "$80", "$160", "$320")) +
labs(title=paste(title, "Nationwide", sep="\n"), x="DRG", y="Average Covered Charges ($1,000s)") +
theme_bw() +
theme(legend.position="bottom", panel.grid.major.x=NULL, panel.grid.major.y=element_line(color="grey"), panel.grid.minor.y=NULL)
}
for (i in 3:3) {
j <- mdcOHSU[i]
d <- subset(dfSubset, mdc == j)
t <- paste("MDC", mdc$mdc[mdc == j], mdc$mdclab[mdc == j])
show(DistnPlot(d, t))
}
DistnPlot <- function(d, title) {
ggplot(d, aes(x=DRGchar, y=Average.Covered.Charges)) +
#     geom_boxplot(alpha=1/2, fill="grey", outlier.size=0) +
geom_violin(alpha=1/2, fill="grey") +
geom_point(data=d[grep("^OR - Portland", d$Hospital.Referral.Region.Description),], alpha=1/2, na.rm=TRUE) +
geom_point(data=d[d$OHSU,], alpha=2/3, color=rgb(0, 73, 144, max=255), size=5) +
facet_wrap(~ type, ncol=1, scales="free") +
scale_y_log10(breaks=c(1E4, 2E4, 4E4, 8E4, 16E4, 32E4), labels=c("$10", "$20", "$40", "$80", "$160", "$320")) +
labs(title=paste(title, "Nationwide", sep="\n"), x="DRG", y="Average Covered Charges ($1,000s)") +
theme_bw() +
theme(legend.position="bottom", panel.grid.major.x=NULL, panel.grid.major.y=element_line(color="grey"), panel.grid.minor.y=NULL)
}
for (i in 3:3) {
j <- mdcOHSU[i]
d <- subset(dfSubset, mdc == j)
t <- paste("MDC", mdc$mdc[mdc == j], mdc$mdclab[mdc == j])
show(DistnPlot(d, t))
}
DistnPlot <- function(d, title) {
ggplot(d, aes(x=DRGchar, y=Average.Covered.Charges)) +
#     geom_boxplot(alpha=1/2, fill="grey", outlier.size=0) +
geom_violin(alpha=1/2, fill="grey") +
geom_jitter(data=d[grep("^OR - Portland", d$Hospital.Referral.Region.Description),], alpha=1/2, na.rm=TRUE) +
geom_point(data=d[d$OHSU,], alpha=2/3, color=rgb(0, 73, 144, max=255), size=5) +
facet_wrap(~ type, ncol=1, scales="free") +
scale_y_log10(breaks=c(1E4, 2E4, 4E4, 8E4, 16E4, 32E4), labels=c("$10", "$20", "$40", "$80", "$160", "$320")) +
labs(title=paste(title, "Nationwide", sep="\n"), x="DRG", y="Average Covered Charges ($1,000s)") +
theme_bw() +
theme(legend.position="bottom", panel.grid.major.x=NULL, panel.grid.major.y=element_line(color="grey"), panel.grid.minor.y=NULL)
}
for (i in 3:3) {
j <- mdcOHSU[i]
d <- subset(dfSubset, mdc == j)
t <- paste("MDC", mdc$mdc[mdc == j], mdc$mdclab[mdc == j])
show(DistnPlot(d, t))
}
?grepl
View(`d2`)
View(`d2`)
